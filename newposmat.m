function a =  newposmat(t,w)
t10 = (t(1));
t20 = (t(2));
t30 = (t(3));
x0 = t(4);
a = zeros(4,4);
a(1,1) = sin(t10 - t20)*exp(-(x0 + cos(t10)/6 - cos(t30)/6)^2/w^2)*cos(t20)^2 - 4*exp(-(cos(t10)/3 - x0 + cos(t20)/2 + cos(t30)/6)^2/w^2)*cos(t10)*sin(t10) + sin(t10 - t30)*exp(-(x0 + cos(t10)/3 + cos(t20)/2 + cos(t30)/6)^2/w^2)*cos(t30)^2 + (exp(-(cos(t10)/3 - x0 + cos(t20)/2 + cos(t30)/6)^2/w^2)*cos(t10)^2*sin(t10)*(cos(t10)/3 - x0 + cos(t20)/2 + cos(t30)/6))/6 - (cos(t10 - t20)*exp(-(x0 + cos(t10)/6 - cos(t30)/6)^2/w^2)*cos(t20)^2*sin(t10)*(x0 + cos(t10)/6 - cos(t30)/6))/24 - (cos(t10 - t30)*exp(-(x0 + cos(t10)/3 + cos(t20)/2 + cos(t30)/6)^2/w^2)*cos(t30)^2*sin(t10)*(x0 + cos(t10)/3 + cos(t20)/2 + cos(t30)/6))/12;
a(1,2) = (exp(-(cos(t10)/3 - x0 + cos(t20)/2 + cos(t30)/6)^2/w^2)*cos(t10)^2*sin(t20)*(cos(t10)/3 - x0 + cos(t20)/2 + cos(t30)/6))/4 - sin(t10 - t20)*exp(-(x0 + cos(t10)/6 - cos(t30)/6)^2/w^2)*cos(t20)^2 + 2*cos(t10 - t20)*exp(-(x0 + cos(t10)/6 - cos(t30)/6)^2/w^2)*cos(t20)*sin(t20) - (cos(t10 - t30)*exp(-(x0 + cos(t10)/3 + cos(t20)/2 + cos(t30)/6)^2/w^2)*cos(t30)^2*sin(t20)*(x0 + cos(t10)/3 + cos(t20)/2 + cos(t30)/6))/w^2;
a(1,3) = (exp(-(cos(t10)/3 - x0 + cos(t20)/2 + cos(t30)/6)^2/w^2)*cos(t10)^2*sin(t30)*(cos(t10)/3 - x0 + cos(t20)/2 + cos(t30)/6))/12 - sin(t10 - t30)*exp(-(x0 + cos(t10)/3 + cos(t20)/2 + cos(t30)/6)^2/w^2)*cos(t30)^2 + 2*cos(t10 - t30)*exp(-(x0 + cos(t10)/3 + cos(t20)/2 + cos(t30)/6)^2/w^2)*cos(t30)*sin(t30) + (cos(t10 - t20)*exp(-(x0 + cos(t10)/6 - cos(t30)/6)^2/w^2)*cos(t20)^2*sin(t30)*(x0 + cos(t10)/6 - cos(t30)/6))/24 - (cos(t10 - t30)*exp(-(x0 + cos(t10)/3 + cos(t20)/2 + cos(t30)/6)^2/w^2)*cos(t30)^2*sin(t30)*(x0 + cos(t10)/3 + cos(t20)/2 + cos(t30)/6))/24;
a(1,4) = (exp(-(cos(t10)/3 - x0 + cos(t20)/2 + cos(t30)/6)^2/w^2)*cos(t10)^2*(cos(t10)/3 - x0 + cos(t20)/2 + cos(t30)/6))/2 + (cos(t10 - t20)*exp(-(x0 + cos(t10)/6 - cos(t30)/6)^2/w^2)*cos(t20)^2*(x0 + cos(t10)/6 - cos(t30)/6))/4 + (cos(t10 - t30)*exp(-(x0 + cos(t10)/3 + cos(t20)/2 + cos(t30)/6)^2/w^2)*cos(t30)^2*(x0 + cos(t10)/3 + cos(t20)/2 + cos(t30)/6))/4;
a(2,1) = sin(t10 - t30)*exp(-(x0 + cos(t10)/3 + cos(t20)/2 + cos(t30)/6)^2/w^2)*cos(t30)^2 - sin(t10 - t20)*exp(-(cos(t10)/3 - x0 + cos(t20)/2 + cos(t30)/6)^2/w^2)*cos(t10)^2 - 2*cos(t10 - t20)*exp(-(cos(t10)/3 - x0 + cos(t20)/2 + cos(t30)/6)^2/w^2)*cos(t10)*sin(t10) + (cos(t10 - t20)*exp(-(cos(t10)/3 - x0 + cos(t20)/2 + cos(t30)/6)^2/w^2)*cos(t10)^2*sin(t10)*(cos(t10)/3 - x0 + cos(t20)/2 + cos(t30)/6))/12 - (cos(t10 - t30)*exp(-(x0 + cos(t10)/3 + cos(t20)/2 + cos(t30)/6)^2/w^2)*cos(t30)^2*sin(t10)*(x0 + cos(t10)/3 + cos(t20)/2 + cos(t30)/6))/12;
a(2,2) = sin(t10 - t20)*exp(-(cos(t10)/3 - x0 + cos(t20)/2 + cos(t30)/6)^2/w^2)*cos(t10)^2 + (cos(t10 - t20)*exp(-(cos(t10)/3 - x0 + cos(t20)/2 + cos(t30)/6)^2/w^2)*cos(t10)^2*sin(t20)*(cos(t10)/3 - x0 + cos(t20)/2 + cos(t30)/6))/w^2 - (cos(t10 - t30)*exp(-(x0 + cos(t10)/3 + cos(t20)/2 + cos(t30)/6)^2/w^2)*cos(t30)^2*sin(t20)*(x0 + cos(t10)/3 + cos(t20)/2 + cos(t30)/6))/w^2;
a(2,3) = 2*cos(t10 - t30)*exp(-(x0 + cos(t10)/3 + cos(t20)/2 + cos(t30)/6)^2/w^2)*cos(t30)*sin(t30) - sin(t10 - t30)*exp(-(x0 + cos(t10)/3 + cos(t20)/2 + cos(t30)/6)^2/w^2)*cos(t30)^2 + (cos(t10 - t20)*exp(-(cos(t10)/3 - x0 + cos(t20)/2 + cos(t30)/6)^2/w^2)*cos(t10)^2*sin(t30)*(cos(t10)/3 - x0 + cos(t20)/2 + cos(t30)/6))/24 - (cos(t10 - t30)*exp(-(x0 + cos(t10)/3 + cos(t20)/2 + cos(t30)/6)^2/w^2)*cos(t30)^2*sin(t30)*(x0 + cos(t10)/3 + cos(t20)/2 + cos(t30)/6))/24;
a(2,4) = (cos(t10 - t20)*exp(-(cos(t10)/3 - x0 + cos(t20)/2 + cos(t30)/6)^2/w^2)*cos(t10)^2*(cos(t10)/3 - x0 + cos(t20)/2 + cos(t30)/6))/4 + (cos(t10 - t30)*exp(-(x0 + cos(t10)/3 + cos(t20)/2 + cos(t30)/6)^2/w^2)*cos(t30)^2*(x0 + cos(t10)/3 + cos(t20)/2 + cos(t30)/6))/4;
a(3,1) = (cos(t20 - t30)*exp(-(x0 + cos(t10)/6 - cos(t30)/6)^2/w^2)*cos(t20)^2*sin(t10)*(x0 + cos(t10)/6 - cos(t30)/6))/24 - 2*cos(t10 - t30)*exp(-(cos(t10)/3 - x0 + cos(t20)/2 + cos(t30)/6)^2/w^2)*cos(t10)*sin(t10) - (exp(-(x0 + cos(t10)/3 + cos(t20)/2 + cos(t30)/6)^2/w^2)*cos(t30)^2*sin(t10)*(x0 + cos(t10)/3 + cos(t20)/2 + cos(t30)/6))/6 - sin(t10 - t30)*exp(-(cos(t10)/3 - x0 + cos(t20)/2 + cos(t30)/6)^2/w^2)*cos(t10)^2 + (cos(t10 - t30)*exp(-(cos(t10)/3 - x0 + cos(t20)/2 + cos(t30)/6)^2/w^2)*cos(t10)^2*sin(t10)*(cos(t10)/3 - x0 + cos(t20)/2 + cos(t30)/6))/12;
a(3,2) = (cos(t10 - t30)*exp(-(cos(t10)/3 - x0 + cos(t20)/2 + cos(t30)/6)^2/w^2)*cos(t10)^2*sin(t20)*(cos(t10)/3 - x0 + cos(t20)/2 + cos(t30)/6))/w^2 - 2*cos(t20 - t30)*exp(-(x0 + cos(t10)/6 - cos(t30)/6)^2/w^2)*cos(t20)*sin(t20) - (exp(-(x0 + cos(t10)/3 + cos(t20)/2 + cos(t30)/6)^2/w^2)*cos(t30)^2*sin(t20)*(x0 + cos(t10)/3 + cos(t20)/2 + cos(t30)/6))/4 - sin(t20 - t30)*exp(-(x0 + cos(t10)/6 - cos(t30)/6)^2/w^2)*cos(t20)^2;
a(3,3) = sin(t20 - t30)*exp(-(x0 + cos(t10)/6 - cos(t30)/6)^2/w^2)*cos(t20)^2 + sin(t10 - t30)*exp(-(cos(t10)/3 - x0 + cos(t20)/2 + cos(t30)/6)^2/w^2)*cos(t10)^2 + 4*exp(-(x0 + cos(t10)/3 + cos(t20)/2 + cos(t30)/6)^2/w^2)*cos(t30)*sin(t30) - (exp(-(x0 + cos(t10)/3 + cos(t20)/2 + cos(t30)/6)^2/w^2)*cos(t30)^2*sin(t30)*(x0 + cos(t10)/3 + cos(t20)/2 + cos(t30)/6))/12 - (cos(t20 - t30)*exp(-(x0 + cos(t10)/6 - cos(t30)/6)^2/w^2)*cos(t20)^2*sin(t30)*(x0 + cos(t10)/6 - cos(t30)/6))/24 + (cos(t10 - t30)*exp(-(cos(t10)/3 - x0 + cos(t20)/2 + cos(t30)/6)^2/w^2)*cos(t10)^2*sin(t30)*(cos(t10)/3 - x0 + cos(t20)/2 + cos(t30)/6))/24;
a(3,4) = (exp(-(x0 + cos(t10)/3 + cos(t20)/2 + cos(t30)/6)^2/w^2)*cos(t30)^2*(x0 + cos(t10)/3 + cos(t20)/2 + cos(t30)/6))/2 - (cos(t20 - t30)*exp(-(x0 + cos(t10)/6 - cos(t30)/6)^2/w^2)*cos(t20)^2*(x0 + cos(t10)/6 - cos(t30)/6))/4 + (cos(t10 - t30)*exp(-(cos(t10)/3 - x0 + cos(t20)/2 + cos(t30)/6)^2/w^2)*cos(t10)^2*(cos(t10)/3 - x0 + cos(t20)/2 + cos(t30)/6))/4;
a(4,1) = 2*exp(-(cos(t10)/3 - x0 + cos(t20)/2 + cos(t30)/6)^2/w^2)*cos(t10)*sin(t10)^2 - exp(-(cos(t10)/3 - x0 + cos(t20)/2 + cos(t30)/6)^2/w^2)*cos(t10)^3 - (exp(-(cos(t10)/3 - x0 + cos(t20)/2 + cos(t30)/6)^2/w^2)*cos(t10)^2*sin(t10)^2*(cos(t10)/3 - x0 + cos(t20)/2 + cos(t30)/6))/12 - (exp(-(x0 + cos(t10)/6 - cos(t30)/6)^2/w^2)*cos(t20)^2*sin(t10)*sin(t20)*(x0 + cos(t10)/6 - cos(t30)/6))/24 - (exp(-(x0 + cos(t10)/3 + cos(t20)/2 + cos(t30)/6)^2/w^2)*cos(t30)^2*sin(t10)*sin(t30)*(x0 + cos(t10)/3 + cos(t20)/2 + cos(t30)/6))/12;
a(4,2) = 2*exp(-(x0 + cos(t10)/6 - cos(t30)/6)^2/w^2)*cos(t20)*sin(t20)^2 - exp(-(x0 + cos(t10)/6 - cos(t30)/6)^2/w^2)*cos(t20)^3 - (exp(-(cos(t10)/3 - x0 + cos(t20)/2 + cos(t30)/6)^2/w^2)*cos(t10)^2*sin(t10)*sin(t20)*(cos(t10)/3 - x0 + cos(t20)/2 + cos(t30)/6))/w^2 - (exp(-(x0 + cos(t10)/3 + cos(t20)/2 + cos(t30)/6)^2/w^2)*cos(t30)^2*sin(t20)*sin(t30)*(x0 + cos(t10)/3 + cos(t20)/2 + cos(t30)/6))/w^2;
a(4,3) = 2*exp(-(x0 + cos(t10)/3 + cos(t20)/2 + cos(t30)/6)^2/w^2)*cos(t30)*sin(t30)^2 - exp(-(x0 + cos(t10)/3 + cos(t20)/2 + cos(t30)/6)^2/w^2)*cos(t30)^3 - (exp(-(x0 + cos(t10)/3 + cos(t20)/2 + cos(t30)/6)^2/w^2)*cos(t30)^2*sin(t30)^2*(x0 + cos(t10)/3 + cos(t20)/2 + cos(t30)/6))/24 + (exp(-(x0 + cos(t10)/6 - cos(t30)/6)^2/w^2)*cos(t20)^2*sin(t20)*sin(t30)*(x0 + cos(t10)/6 - cos(t30)/6))/24 - (exp(-(cos(t10)/3 - x0 + cos(t20)/2 + cos(t30)/6)^2/w^2)*cos(t10)^2*sin(t10)*sin(t30)*(cos(t10)/3 - x0 + cos(t20)/2 + cos(t30)/6))/24;
a(4,4) = (exp(-(x0 + cos(t10)/6 - cos(t30)/6)^2/w^2)*cos(t20)^2*sin(t20)*(x0 + cos(t10)/6 - cos(t30)/6))/4 - (exp(-(cos(t10)/3 - x0 + cos(t20)/2 + cos(t30)/6)^2/w^2)*cos(t10)^2*sin(t10)*(cos(t10)/3 - x0 + cos(t20)/2 + cos(t30)/6))/4 + (exp(-(x0 + cos(t10)/3 + cos(t20)/2 + cos(t30)/6)^2/w^2)*cos(t30)^2*sin(t30)*(x0 + cos(t10)/3 + cos(t20)/2 + cos(t30)/6))/4;
a([1:3],[1:3]) = a([1:3],[1:3])/3;

end


 








